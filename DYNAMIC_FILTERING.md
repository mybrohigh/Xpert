# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∏–Ω–≥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üéØ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

Xpert Panel —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä—ã –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–∏–Ω–≥–∞, –Ω–æ –∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ **—Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–∏–Ω–≥–æ–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**.

## üìã –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### **1. –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–∏–Ω–≥—É—é—Ç —Å–µ—Ä–≤–µ—Ä—ã –∏–∑ –ø–æ–¥–ø–∏—Å–∫–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ API `/api/xpert/ping-report`
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `xpert_ping_stats.json`

### **2. –ê–Ω–∞–ª–∏–∑ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–æ–≤**
- **Success Rate** - –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –ø–∏–Ω–≥–æ–≤ (–º–∏–Ω–∏–º—É–º 70%)
- **Average Ping** - —Å—Ä–µ–¥–Ω–∏–π –ø–∏–Ω–≥ (–º–∞–∫—Å–∏–º—É–º 1000–º—Å)
- **Unique Users** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–º–∏–Ω–∏–º—É–º 3)

### **3. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è**
- –ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –°–µ—Ä–≤–µ—Ä—ã —Å –ø–ª–æ—Ö–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è
- –ï—Å–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

## üõ† API –¥–ª—è —Å–±–æ—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### **POST /api/xpert/ping-report**
–ó–∞–ø–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–∏–Ω–≥–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```json
{
  "server": "example.com",
  "port": 443,
  "protocol": "vless",
  "ping_ms": 150.5,
  "success": true
}
```

### **GET /api/xpert/server-health/{server}/{port}/{protocol}**
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞:

```json
{
  "healthy": true,
  "avg_ping": 145.2,
  "success_rate": 85.5,
  "total_pings": 45,
  "unique_users": 8
}
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

```bash
# –í–∫–ª—é—á–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
XPERT_USE_DYNAMIC_FILTERING=true

# –û—Ç–∫–ª—é—á–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é
XPERT_USE_DYNAMIC_FILTERING=false

# –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
XPERT_MIN_USERS_FOR_STATS=3
```

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏

### **–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏–Ω–≥–æ–≤:**

```python
import requests
import time

def ping_server(server: str, port: int, protocol: str):
    start_time = time.time()
    success = False
    
    try:
        # –í–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–∏–Ω–≥–∞
        result = ping_function(server, port)
        ping_ms = (time.time() - start_time) * 1000
        success = True
    except:
        ping_ms = 9999.0
    
    # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    requests.post("https://your-domain.com/api/xpert/ping-report", json={
        "server": server,
        "port": port, 
        "protocol": protocol,
        "ping_ms": ping_ms,
        "success": success
    })
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **GET /api/xpert/ping-stats**
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–æ–¥–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:

```json
{
  "total_ping_records": 1250,
  "unique_servers": 45,
  "unique_users": 23,
  "last_cleanup": "2026-01-30T23:00:00"
}
```

### **POST /api/xpert/cleanup-stats**
–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7 –¥–Ω–µ–π):

```bash
curl -X POST "https://your-domain.com/api/xpert/cleanup-stats?days=7"
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–†–µ–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
‚úÖ **–ì–µ–æ–∞–¥–∞–ø—Ç–∞—Ü–∏—è** - —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤  
‚úÖ **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞** - –ø–ª–æ—Ö–∏–µ —Å–µ—Ä–≤–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è  
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç  

## üìù Workflow

1. **–ù–∞—á–∞–ª–æ** - –≤—Å–µ —Å–µ—Ä–≤–µ—Ä—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
2. **–ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–∏–Ω–≥—É—é—Ç, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞—Å—Ç–µ—Ç
3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - —Å–µ—Ä–≤–µ—Ä—ã —Å –ø–ª–æ—Ö–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è
4. **–û—á–∏—Å—Ç–∫–∞** - —Å—Ç–∞—Ä–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### **–°–µ—Ä–≤–µ—Ä—ã –Ω–µ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `XPERT_USE_DYNAMIC_FILTERING=true`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (`XPERT_MIN_USERS_FOR_STATS`)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫–ª–∏–µ–Ω—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –ø–∏–Ω–≥–∏

### **–ú–∞–ª–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
- –£–≤–µ–ª–∏—á—å—Ç–µ –≤—Ä–µ–º—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
- –£–º–µ–Ω—å—à–∏—Ç–µ `XPERT_MIN_USERS_FOR_STATS`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

### **–°–µ—Ä–≤–µ—Ä—ã –∏—Å—á–µ–∑–∞—é—Ç:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä–æ–≥–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (70% success, 1000ms ping)
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- –í–æ–∑–º–æ–∂–Ω–æ —Å–µ—Ä–≤–µ—Ä –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
